<!DOCTYPE html>
<html  >
<head>
  <!-- Site made with Mobirise Website Builder v5.4.1, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v5.4.1, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/icons8-console-100.png" type="image/x-icon">
  <meta name="description" content="Manually enabling Kernel Debugging on Windows 10 Mobile">
  
  
  <title>W10MKD</title>
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons2/mobirise2.css">
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/socicon/css/styles.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Source+Code+Pro:200,300,400,500,600,700,800,900,200i,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro:200,300,400,500,600,700,800,900,200i,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
  
  
  
  
</head>
<body>
  
  <section data-bs-version="5.1" class="menu menu3 cid-sJ5gshHKRf" once="menu" id="menu3-l">
    
    <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
        <div class="container-fluid">
            <div class="navbar-brand">
                
                <span class="navbar-caption-wrap"><a class="navbar-caption text-warning text-primary display-7" href="index.html">Empy's Board<br></a></span>
            </div>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbarSupportedContent" data-bs-target="#navbarSupportedContent" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav nav-dropdown" data-app-modern-menu="true"><li class="nav-item dropdown"><a class="nav-link link text-warning text-primary dropdown-toggle display-7" href="#" target="_blank" data-bs-auto-close="outside" aria-expanded="false" data-toggle="dropdown-submenu" data-bs-toggle="dropdown">My Apps</a><div class="dropdown-menu" aria-labelledby="dropdown-undefined"><a class="text-warning text-primary dropdown-item display-7" href="APManager.html" data-bs-auto-close="outside" aria-expanded="false">Astoria Package Manager</a><a class="text-warning text-primary dropdown-item display-7" href="easybuild.html" data-bs-auto-close="outside" aria-expanded="false">Easy-Build</a><a class="text-warning text-primary dropdown-item display-7" href="EasyFetch.html" data-bs-auto-close="outside" aria-expanded="false">Easy-Fetch</a><a class="text-warning text-primary dropdown-item display-7" href="https://github.com/Empyreal96/MinidumpViewer.UWP" target="_blank" data-bs-auto-close="outside" aria-expanded="false">Minidump Viewer UWP</a><a class="text-warning text-primary dropdown-item display-7" href="W10MToolbox.html" data-bs-auto-close="outside" aria-expanded="false">Windows 10 Mobile Toolbox</a><a class="text-warning text-primary dropdown-item display-7" href="W10Toolbox.html" data-bs-auto-close="outside" aria-expanded="false">Windows 10 Toolbox</a><a class="text-warning text-primary dropdown-item display-7" href="WPDevPortal.html" data-bs-auto-close="outside" aria-expanded="false">WPDevPortal</a></div></li><li class="nav-item dropdown"><a class="nav-link link text-warning text-primary dropdown-toggle display-7" href="#" target="_blank" data-bs-auto-close="outside" aria-expanded="false" data-toggle="dropdown-submenu" data-bs-toggle="dropdown">Sources</a><div class="dropdown-menu" aria-labelledby="dropdown-undefined"><a class="text-warning text-primary show dropdown-item display-7" href="MSXDE.html" data-bs-auto-close="outside" aria-expanded="false">Microsoft Emulator (XDE)</a><a class="text-warning text-primary show dropdown-item display-7" href="WDRTSrc.html" data-bs-auto-close="outside" aria-expanded="false" data-bs-toggle="dropdown">Windows Device Recovery Tool Libraries</a><a class="text-warning text-primary show dropdown-item display-7" href="WCAgentSrc.html" data-bs-auto-close="outside" aria-expanded="false" data-bs-toggle="dropdown">WConnect Agent</a><a class="text-warning text-primary show dropdown-item display-7" href="WPToolsSrc.html" data-bs-auto-close="outside" aria-expanded="false" data-bs-toggle="dropdown">WP SDK Tools</a></div></li><li class="nav-item dropdown"><a class="nav-link link text-warning text-primary dropdown-toggle display-7" href="#" target="_blank" data-bs-auto-close="outside" aria-expanded="false" data-toggle="dropdown-submenu" data-bs-toggle="dropdown">WP Resources</a><div class="dropdown-menu" aria-labelledby="dropdown-undefined"><a class="text-warning text-primary show dropdown-item display-7" href="WP8.1OEM.html" data-bs-auto-close="outside" aria-expanded="false">Archived WP8.1 OEM Documentation</a><a class="text-warning text-primary show dropdown-item display-7" href="W10MKD.html" data-bs-auto-close="outside" aria-expanded="false">Manually Enabling Kernel Debugging</a><a class="text-warning text-primary show dropdown-item display-7" href="WPAKs.html" data-bs-auto-close="outside" aria-expanded="false">Windows 10 Mobile WPAKs</a><a class="text-warning text-primary show dropdown-item display-7" href="https://github.com/Empyreal96/WPCabLinks.db" target="_blank" data-bs-auto-close="outside" aria-expanded="false">Windows Phone/Mobile Update Cabs</a><a class="text-warning text-primary show dropdown-item display-7" href="W10MXMi4.html" data-bs-auto-close="outside" aria-expanded="false">Xiaomi MI4 W10M Build 10586</a></div></li><li class="nav-item dropdown"><a class="nav-link link text-warning text-primary dropdown-toggle display-7" href="#" target="_blank" data-bs-auto-close="outside" aria-expanded="false" data-toggle="dropdown-submenu" data-bs-toggle="dropdown">Guides</a><div class="dropdown-menu" aria-labelledby="dropdown-undefined"><a class="text-warning text-primary dropdown-item display-7" href="LinuxOn950s.html" data-bs-auto-close="outside" aria-expanded="true">Linux on 950/XL</a><a class="text-warning text-primary dropdown-item display-7" href="LinuxOnLinx.html" data-bs-auto-close="outside" aria-expanded="true">Linux on Linx 1010</a></div></li></ul>
                <div class="icons-menu">
                    <a class="iconfont-wrapper" href="https://t.me/empysboard" target="_blank">
                        <span class="p-2 mbr-iconfont mobi-mbri-paper-plane mobi-mbri" style="color: rgb(194, 97, 255); fill: rgb(194, 97, 255);"></span>
                    </a>
                    <a class="iconfont-wrapper" href="https://twitter.com/GingerGunt" target="_blank">
                        <span class="p-2 mbr-iconfont socicon-twitter socicon" style="color: rgb(194, 97, 255); fill: rgb(194, 97, 255);"></span>
                    </a>
                    
                    
                </div>
                <div class="navbar-buttons mbr-section-btn"><a class="btn btn-warning display-4" href="https://github.com/empyreal96" target="_blank">GitHub</a></div>
            </div>
        </div>
    </nav>
</section>

<section data-bs-version="5.1" class="header3 cid-sJbVyigEL9" id="header3-m">

    

    <div class="mbr-overlay" style="opacity: 0.5; background-color: rgb(53, 53, 53);"></div>

    <div class="align-center container">
        <div class="row justify-content-end">
            <div class="col-12 col-lg-6">
                <h1 class="mbr-section-title mbr-fonts-style mb-3 display-2"><strong>Manually Enabling Kernel Debugging in W10M</strong></h1>
                
                <p class="mbr-text mbr-fonts-style display-7">Follow these steps to enable Kernel Debugging on your Windows Mobile device to allow you to connect to WinDbg over USB (other methods also exist but are not covered here.. yet)</p>
                
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content14 cid-sJbWMloUVC" id="content14-o">
    
    
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                    <h3 class="mbr-section-title mbr-fonts-style mb-4 display-2">
                        <strong>Requirements:</strong></h3>
                <ul class="list mbr-fonts-style display-7">
                    <li><strong><a href="https://github.com/Empyreal96/Empys-board/raw/main/files/W10M_KD.zip" class="text-warning" target="_blank"><b>Kernel Debug files</b></a> </strong>from Windows IoT ARM32, <em>you may not need all the files.</em></li>
                    <li><strong><a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/debugger-download-tools" class="text-warning" target="_blank"><b>WinDbg Classic</b></a>/<b><a href="https://www.microsoft.com/en-gb/p/windbg-preview/9pgjgd53tn86" class="text-warning" target="_blank"><b>WinDbg Preview</b></a>&nbsp;</b></strong>Installed and set up.</li>
                    <li><strong>USB Data Cable</strong></li>
                    <li><strong>Internet Access/Offline Debugging Symbols</strong>&nbsp;Internet Access is the&nbsp;<em>preferred method</em> as Microsoft stopped Symbol Packs and WinDbg will attempt to fetch any symbols needed. Offline ones I provide are not many but can be hound <a href="https://github.com/Empyreal96/Windows-10-Mobile-Public-Symbols" class="text-warning" target="_blank">here</a>.</li>
                    <li><strong>Access to Mass Storage Mode </strong>Either with Unlocked Bootloader and Developer Menu, or Interop Unlocked with Production Developer Menu.&nbsp;<em>(production version not compatible with 15xxx builds)</em></li>
                </ul>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content16 cid-sJbYVxvoIM" id="content16-p">

    

    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <div class="mbr-section-head align-center mb-4">
                    <h3 class="mbr-section-title mb-0 mbr-fonts-style display-2"><strong>Guide</strong></h3>
                    <h4 class="mbr-section-subtitle mb-0 mt-2 mbr-fonts-style display-7">
                       Make sure to fetch the Requirements above. Any drive paths below (e.g D:\EFIESP) change it to what letter your MainOS drive is.</h4>
                </div>
                <div id="bootstrap-accordion_45" class="panel-group accordionStyles accordion" role="tablist" aria-multiselectable="true">
                    <div class="card mb-3">
                        <div class="card-header" role="tab" id="headingOne">
                            <a role="button" class="panel-title collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-core="" href="#collapse1_45" aria-expanded="false" aria-controls="collapse1">
                                <h6 class="panel-title-edit mbr-fonts-style mb-0 display-7"><strong>Enter Mass Storage Mode and Backing up the BCD file.</strong></h6>
                                <span class="sign mbr-iconfont mbri-arrow-down"></span>
                            </a>
                        </div>
                        <div id="collapse1_45" class="panel-collapse noScroll collapse" role="tabpanel" aria-labelledby="headingOne" data-parent="#bootstrap-accordion_45" data-bs-parent="#accordion">
                            <div class="panel-body">
                                <p class="mbr-fonts-style panel-text display-4">- Enter Mass Storage and connect to your PC.&nbsp;<br>- Navigate to "<strong>D:\EFIESP\EFI\Microsoft\Boot\</strong>" and make a copy of the file "<strong>BCD</strong>"<br></p>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3">
                        <div class="card-header" role="tab" id="headingOne">
                            <a role="button" class="panel-title collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-core="" href="#collapse2_45" aria-expanded="false" aria-controls="collapse2">
                                <h6 class="panel-title-edit mbr-fonts-style mb-0 display-7"><strong>Open Command Prompt as Administrator and Apply BCD Commands.</strong></h6>
                                <span class="sign mbr-iconfont mbri-arrow-down"></span>
                            </a>
                        </div>
                        <div id="collapse2_45" class="panel-collapse noScroll collapse" role="tabpanel" aria-labelledby="headingOne" data-parent="#bootstrap-accordion_45" data-bs-parent="#accordion">
                            <div class="panel-body">
                                <p class="mbr-fonts-style panel-text display-4">
                                    - Open Command Prompt as an Administrator<br>- Type these commands pressing enter after each command:<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <strong>bcdedit /store "D:\EFIESP\EFI\Microsoft\Boot\BCD" /set {default} debug on
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bcdedit /store "D:\EFIESP\EFI\Microsoft\Boot\BCD" /dbgsettings usb targetname:WINMOB
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bcdedit /store "D:\EFIESP\EFI\Microsoft\Boot\BCD" /set {default} dbgtransport kdusb.dll</strong><br><br>- You can close the Command Prompt Window now.</p>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3">
                        <div class="card-header" role="tab" id="headingOne">
                            <a role="button" class="panel-title collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-core="" href="#collapse3_45" aria-expanded="false" aria-controls="collapse3">
                                <h6 class="panel-title-edit mbr-fonts-style mb-0 display-7"><strong>Copy the files needed by Windows Mobile.</strong></h6>
                                <span class="sign mbr-iconfont mbri-arrow-down"></span>
                            </a>
                        </div>
                        <div id="collapse3_45" class="panel-collapse noScroll collapse" role="tabpanel" aria-labelledby="headingOne" data-parent="#bootstrap-accordion_45" data-bs-parent="#accordion">
                            <div class="panel-body">
                                <p class="mbr-fonts-style panel-text display-4">- Extract/Open "<strong>W10M_kd.zip</strong>" and copy the files to&nbsp;"<strong>D:\Windows\System32</strong>". Don't replace any files that ask to be replaced <em>(No issue if you do replace)&nbsp;</em></p>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3">
                        <div class="card-header" role="tab" id="headingOne">
                            <a role="button" class="panel-title collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-core="" href="#collapse4_45" aria-expanded="false" aria-controls="collapse4">
                                <h6 class="panel-title-edit mbr-fonts-style mb-0 display-7"><strong>Setting up WinDbg ready to debug your device.</strong></h6>
                                <span class="sign mbr-iconfont mbri-arrow-down"></span>
                            </a>
                        </div>
                        <div id="collapse4_45" class="panel-collapse noScroll collapse" role="tabpanel" aria-labelledby="headingOne" data-parent="#bootstrap-accordion_45" data-bs-parent="#accordion">
                            <div class="panel-body">
                                <p class="mbr-fonts-style panel-text display-4">
                                    - Launch WinDbg as Administrator.<br>- Goto [<strong>File &gt; Attach a Kernel &gt; USB</strong> Tab]<br>-&nbsp;In the "<strong>Target Name</strong>" box type: WINMOB<br>- (<strong>Optional</strong>) Tick Break on Connection it interrupt Booting with the debugger<br>-&nbsp;(<strong>First Run of WinDbg</strong>) When asked to install a driver from 'Microsoft', <strong>accept installing the driver</strong>. It is for <strong>USB Debugging Drivers</strong></p>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3">
                        <div class="card-header" role="tab" id="headingOne">
                            <a role="button" class="panel-title collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-core="" href="#collapse5_45" aria-expanded="false" aria-controls="collapse5">
                                <h6 class="panel-title-edit mbr-fonts-style mb-0 display-7"><strong>Reboot the Device with USB Cable still attached.</strong></h6>
                                <span class="sign mbr-iconfont mbri-arrow-down"></span>
                            </a>
                        </div>
                        <div id="collapse5_45" class="panel-collapse noScroll collapse" role="tabpanel" aria-labelledby="headingOne" data-parent="#bootstrap-accordion_45" data-bs-parent="#accordion">
                            <div class="panel-body">
                                <p class="mbr-fonts-style panel-text display-4">
                                    - Reboot back into "<strong>Normal Mode</strong>"<br>- <strong>Windbg should detect the device during boot!</strong></p>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3">
                        <div class="card-header" role="tab" id="headingOne">
                            <a role="button" class="panel-title collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-core="" href="#collapse6_45" aria-expanded="false" aria-controls="collapse6">
                                <h6 class="panel-title-edit mbr-fonts-style mb-0 display-7"><strong>Notes and How to turn off KD.</strong></h6>
                                <span class="sign mbr-iconfont mbri-arrow-down"></span>
                            </a>
                        </div>
                        <div id="collapse6_45" class="panel-collapse noScroll collapse" role="tabpanel" aria-labelledby="headingOne" data-parent="#bootstrap-accordion_45" data-bs-parent="#accordion">
                            <div class="panel-body">
                                <p class="mbr-fonts-style panel-text display-4">
                                    - MTP/Data Access may be blocked while Kernel Debugging is active.<br>- Device will likely run a bit slower, this is standard when Debugging.<br>- Debugging Symbols are publically available on Microsoft Symbol Servers, WinDbg will attempt to download the .pdb file needed.<br><br><strong>How to Disable KD</strong><br><strong>- </strong>Either Copy back your backed up <strong>BCD</strong> file<br><strong>or </strong><br><strong>- </strong>Enter<strong> Mass Storage Mode </strong>and run this command like above:<br><br>&nbsp; &nbsp; &nbsp; &nbsp;<strong>&nbsp;          bcdedit /store "D:\EFIESP\EFI\Microsoft\Boot\BCD" /set {default} debug off</strong></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section><section style="background-color: #fff; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif; color:#aaa; font-size:12px; padding: 0; align-items: center; display: flex;"><a href="https://mobirise.site/d" style="flex: 1 1; height: 3rem; padding-left: 1rem;"></a><p style="flex: 0 0 auto; margin:0; padding-right:1rem;">Start a free website - <a href="https://mobirise.site/v" style="color:#aaa;">Details here</a></p></section><script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>  <script src="assets/smoothscroll/smooth-scroll.js"></script>  <script src="assets/ytplayer/index.js"></script>  <script src="assets/dropdown/js/navbar-dropdown.js"></script>  <script src="assets/mbr-switch-arrow/mbr-switch-arrow.js"></script>  <script src="assets/theme/js/script.js"></script>  
  
  
</body>
</html>